# 5.1 가설검정의 원리

## 가설검정이란?
- 분석자가 세운 가설을 검증하기 위한 방법
- **p값(p-value)** 을 계산하여 가설을 지지하는지 여부 판단
- 과학 논문에서 자주 등장하지만 오해가 많은 개념

---

## 확증적 자료분석 vs 탐색적 자료분석
### 확증적 자료분석
- 미리 가설을 세움: "신약에 효과가 있다"
- 가설과 관련된 데이터 수집 → 가설 검증
- 실험·관찰로 증명

### 탐색적 자료분석
- 가설 없음
- 데이터를 다양하게 탐색, 경향 파악
- 가설 후보를 찾는 것이 목적

---

## 가설검정 과정 예시
- 실험군(treatment group)과 대조군(control group) 비교
- 예: 고혈압 환자에게 신약 투여 실험  
  - 실험군: 신약 투여  
  - 대조군: 위약 투여  
- 두 집단의 혈압 차이 비교

---

## 통계학에서 가설
- "신약에 효과가 있다" = 두 모집단의 평균이 서로 다르다
  - 귀무가설 H0: μA = μB (효과 없음)
  - 대립가설 H1: μA ≠ μB (효과 있음)

---

## 귀무가설과 대립가설
- **귀무가설(null hypothesis, H0)**: 효과 없음  
- **대립가설(alternative hypothesis, H1)**: 효과 있음  
- 가설검정은 귀무가설을 세운 후, 데이터를 통해 이를 기각하고 대립가설을 지지하는 흐름

---

## 모집단과 표본
- 모집단의 평균 μ는 직접 관찰 불가
- 표본을 통해 추정
- 표본평균 차이 x̄A - x̄B 가 단순한 오차인지, 아니면 실제 효과인지 구별 필요

---

## 표본평균의 분포
- 동일 모집단에서 표본을 여러 번 추출하면 표본평균 차이는 확률적으로 분포
- 이 분포를 통해 실제 데이터 차이가 **우연**인지 **효과**인지 판단

---

## p값 (p-value)
- 정의: 귀무가설이 참일 때, 실제 데이터만큼 극단적인 값이 나올 확률
- 범위: 0 ~ 1 사이 확률값

### 해석
- p값이 작다 → 귀무가설 하에서 관찰된 결과가 드물다  
  → 귀무가설 기각, 대립가설 지지  
- p값이 크다 → 관찰된 결과가 흔하다  
  → 귀무가설 기각 불가

---

## p값과 유의수준 α
- 보통 α = 0.05 사용
- **p < 0.05** → 귀무가설 기각, "통계적으로 유의미한 차이가 있다"
- **p ≥ 0.05** → 귀무가설 기각 불가, "유의미한 차이를 발견하지 못했다"

---

## 핵심 정리
1. 가설검정은 귀무가설과 대립가설을 세우고, 데이터를 통해 판단
2. p값은 귀무가설이 옳다는 가정 하에서 얻은 데이터가 얼마나 드문지를 나타냄
3. 유의수준 α와 비교해 가설 기각 여부 결정
4. **주의**: p값이 작다고 해서 대립가설이 100% 옳다는 뜻은 아님

---

# 5.2 가설검정 시행

## 가설검정의 구체적인 계산
- 가설검정의 개념은 모든 검정기법에서 공통적이지만, **p값 계산 방법은 다름**  
- 실제 계산은 통계 소프트웨어(R 등)에 의해 수행되므로 원리 이해가 중요  
- 예시: **이표본 t검정(two-sample t-test)**

---

## 이표본 t검정 원리
- 두 집단의 평균 차이를 비교하는 방법
- 귀무가설 H0: μA - μB = 0  
- 대립가설 H1: μA - μB ≠ 0  

### 표본평균 차이
- Δ = (x̄A - x̄B) - (μA - μB)  
- 귀무가설 성립 시 Δ ~ 0 근사  
- 표본 오차 반영하여 t분포를 따름

---

## 표본 분산과 표준편차
- 두 집단의 분산 sA², sB²
- 비편향표준편차를 결합한 **풀링 분산** 사용  


---

## t 통계량 계산
- t값이 분포의 양 끝(기각역)에 위치할수록 귀무가설 기각

---

## 기각역과 p값
- 유의수준 α = 0.05 → 양쪽 2.5%씩 총 5% 기각역  
- 실제 t값이 기각역에 포함되면 p < 0.05 → 귀무가설 기각  
- p값 = 실제 t값 이상으로 극단적 값이 나올 확률  

### 양측검정 vs 단측검정
- **양측검정**: 효과가 양·음 모두 가능할 때 (일반적)  
- **단측검정**: 효과 방향을 특정할 때

---

## 신뢰구간과 가설검정
- p값 계산 원리와 신뢰구간은 동일  
- 95% 신뢰구간에 0이 포함되지 않으면 → p < 0.05와 동일한 결론  
- 즉, 두 방법은 동전의 양면 관계

---

## 예시 1
- 데이터: 신약군과 위약군 혈압 비교  
- 표본평균 차이: -10.9  
- t = -2.73, p = 0.018  
- 결론: p < 0.05 → 귀무가설 기각, 신약 효과 있음

---

## 예시 2
- 데이터: 신약군 혈압 차이 -4.9  
- t = -1.22, p = 0.246  
- 결론: p ≥ 0.05 → 귀무가설 기각 불가, 효과 없음

---

# 5.3 가설검정 관련 그래프

## 오차 막대(Error Bar)
- 반복된 데이터의 평균값에 **불확실성** 표시  
- 목적에 따라 다른 오차 막대 사용

### 종류
1. **평균 ± 표준오차 (mean ± SE, SEM)**  
   - 평균값의 추정 정확도 나타냄
2. **평균 ± 95% 신뢰구간**  
   - 모집단 평균 추정 범위
3. **평균 ± 표준편차 (mean ± SD)**  
   - 데이터 자체의 퍼짐 정도  

---

## 그래프 작성 시 주의
- 오차 막대가 무엇을 의미하는지 반드시 명시
- 오차 막대가 겹친다고 반드시 효과 없음은 아님
- 통계적 유의성 판정은 별도의 검정 필요

---

## **5.4 제1종 오류와 제2종 오류**

## **진실과 판단의 4패턴**
- 귀무가설(H0)과 대립가설(H1)은 서로 반대 관계  
- 실제 상태(진실)과 우리의 판단이 일치/불일치할 수 있음 → **2×2 패턴**

---

## **제1종 오류 (Type I Error, False Positive)**
- **정의**: 실제로 차이가 없는데 있다고 잘못 판단하는 오류  
- **발생 확률**: α (유의수준)  
- **예시**: α=0.05 → 귀무가설이 참일 때 20번 중 1번 잘못 기각  
- **해석**: 약 효과가 없는데 있다고 주장하는 오류

---

## **제2종 오류 (Type II Error, False Negative)**
- **정의**: 실제로 차이가 있는데 없다고 잘못 판단하는 오류  
- **발생 확률**: β  
- **검정력 (Power)**: 1 - β (실제로 차이가 있을 때 올바르게 발견할 확률)  
- **해석**: 약 효과가 있는데 없다고 판단하는 오류

---

## **α와 β의 상충 관계**
- **Trade-off 관계**: α를 줄이면(0.05 → 0.01) → 제1종 오류↓, 제2종 오류(β)↑  
- **표본크기 n 영향**  
  - n 커질수록 → α는 동일하게 유지하면서 β 감소  
  - 즉, 표본이 클수록 검정력이 커짐

---

## **효과크기 (Effect Size, d)**
- **정의**: 실제 차이가 얼마나 큰지 나타내는 지표  
- **계산식**:  
  d = ( μA - μB ) / σ  
- **해석**:  
  - d가 클수록 → 차이가 크고 검정 용이  
  - d가 작을수록 → 차이가 작아 차이를 발견하기 어려움

---

## **효과크기·α·β·표본크기의 관계**
- 네 가지 값 **(효과크기 d, 유의수준 α, 제2종 오류 β, 표본크기 n)** 중 3개를 정하면 나머지 1개는 자동으로 결정  
- 연구 설계 단계에서 원하는 **효과크기와 검정력**을 설정 → 필요한 표본크기 n 계산 가능

